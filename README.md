# _Project for AMLS_assignment20_21_

This project completes the assignment released by AMLS in 2020-21


## _Description_

In the project, different ML algorithms were manipulated to solve four facial classification problems.
One of them was chosen  as the final solution.


The overall structure is:

**[1] Four models folder:** A1, A2, B1, B2 (contains final codes used for solving task(model_\~.py), codes for other 
possible models (\~_a1.py,\~_a2.py...), 
codes for feature extraction(dlib_feature_extract\_\~.py,dlib_feature_extract\_\~_test.py))

**[2] Four pre-trained models** model_a1.pkl, model_a2.pkl, model_b1.pkl, model_b2.pkl

**[3] One dataset folder:** Datasets (should be given initial set, added test set for cartoon image; initial set, added test set for CelebA image)

**[4] One main code:** main.py (here all final model's performance can be shown; the result can be either based on pre-trained model or re-trained model)

**[5] Three images:** overall.png, for_main.png, for_other.png (these images were added to explain overall project structure, the "basedir" for main.py,
 the "basedir" for other codes)

**[6] Others:** venv, .gitignore, .idea (PyCharm project file, git file, can be ignored) 


Note: 

To successfully run the main.py, a file named "shape_predictor_68_face_landmarks.dat" need to be add to the same
path of main.py.
  
main.py provides a way to assess and re-train model. However, each file inside A1, A2, B1, B2 can also work. If want to try them, same .dat file
is required to be added under the corresponding path

This .dat file along with full dataset was uploaded to OneDrive. The link can be viewed in report and below:

https://liveuclac-my.sharepoint.com/:f:/g/personal/uceexl4_ucl_ac_uk/ErTmxrWYM-hEnhrDEQkE5v0BiV-Jh8XZd0fsKkdUjvawfA

## _Structure_

### A1

#### model_a1.py
This code contains the functions used in main.py. The detailed description, implementation and result
can be found in report. The code in this file has the most strict and complete form and can be used for marking.

#### knn_a1.py/rand_forest_a1.py/svm_a1.py/mlp_a1.py/cnn_a1.py
(To run these codes, two things need to be done: 1.add dlib .dat file to the relevant directory;
2.change the parameter "basedir" in code of dlib_feature_extract_~.py and dlib_feature_extract_~_test.py from os.getcwd() to os.path.dirname(os.getcwd())) 

These codes contain different model's training and testing pipline. The codes here are not as strict or complete as model
_a1.py. They're for playing. Still, they can give complete model training procedure including feature extraction, training, 
validation, testing...The plots generated by these codes were attached to the report appendix.

#### dlib_feature_extract_a1.py/dlib_feature_extract_a1_test.py
These two files were built based on the one provided in lab. They realize automatic image loading, dlib 68 key points 
extraction and label extraction. They can also return the coordinates of these points and marked images. The only difference
between them is loaded data. One is for loading images and labels provided initially for training. One is for loading images
and labels in additional test set.

Note: 

To fit main.py, the path inside these two don't work for codes in A1. If want to run other codes, please change the base 
path in these two codes from os.getcwd() to os.path.dirname(os.getcwd())

### A2/B1/B2
Note:
 
The directory A2, B1, B2 has the same structure with A1 and therefore the details will not be repeated.
### Datasets
This directory is empty but should be loaded by complete datasets. Just put following directories in this directory:

[1]cartoon_set;

[2]cartoon_set_test;

[3]celeba;

[4]celeba_test

The dataset can be downloaded from OneDrive. The link is released above.

### venv(just ignore)
This directory contains some PyCharm project information such license and so on.

### .gitignore(just ignore)
This is a git project file telling Git which files will not be added into version control.

### main.py(!)
This code will generate training and test set and then loaded the pre-trained models for giving training and testing accuracies. 
If want to re-train the model, please umcomment the relevant sentence inside.
## _Package_


matplotlib

numpy

sklearn

joblib

os

keras

cv2

dlib

platform

pandas

tensorflow


